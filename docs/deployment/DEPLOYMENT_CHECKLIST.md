# 云端部署检查清单

在部署到生产环境之前，请确保完成以下所有检查项。

---

## ✅ 部署前检查

### 服务器准备
- [ ] 服务器已购买（2核4G+，推荐4核8G）
- [ ] 操作系统已安装（Ubuntu 20.04+ 或 CentOS 7+）
- [ ] 服务器有公网IP
- [ ] 防火墙已配置（开放80、443端口）
- [ ] SSH访问正常

### 域名和证书
- [ ] 域名 `yijingcv.cn` 已注册
- [ ] DNS A记录已添加，指向服务器IP
- [ ] DNS解析已生效（ping yijingcv.cn）
- [ ] SSL证书文件已准备（.crt 和 .key）
- [ ] 证书有效期检查（至少3个月）

### 软件环境
- [ ] Docker已安装（20.10+）
- [ ] Docker Compose已安装（2.0+）
- [ ] Git已安装
- [ ] 磁盘空间充足（至少50GB可用）

### API密钥
- [ ] Claude API密钥已获取
- [ ] API密钥已测试可用
- [ ] API配额充足

---

## ✅ 配置检查

### 环境变量
- [ ] `.env.production` 文件已创建
- [ ] MySQL root密码已设置（强密码）
- [ ] MySQL用户密码已设置（强密码）
- [ ] JWT密钥已生成（至少32位）
- [ ] 加密密钥已生成（16字节十六进制）
- [ ] Claude API密钥已配置
- [ ] 所有密码和密钥已妥善保存

### SSL证书
- [ ] 证书文件已上传到 `ssl/` 目录
- [ ] 证书文件权限正确（.key文件600权限）
- [ ] 证书路径在Nginx配置中正确
- [ ] 证书和域名匹配

### Docker配置
- [ ] `docker-compose.yml` 配置已检查
- [ ] 端口映射正确（80、443、3000、3306）
- [ ] 卷挂载路径正确
- [ ] 网络配置正确

---

## ✅ 部署检查

### 容器启动
- [ ] MySQL容器启动成功
- [ ] 应用容器启动成功
- [ ] Nginx容器启动成功
- [ ] 所有容器健康检查通过

### 数据库初始化
- [ ] 数据库已创建
- [ ] 所有表已创建
- [ ] 存储过程已创建
- [ ] 视图已创建
- [ ] 超级管理员账户已创建
- [ ] 系统配置已插入

### 网络连接
- [ ] 容器间网络通信正常
- [ ] 应用可以连接MySQL
- [ ] Nginx可以代理到应用
- [ ] 外部可以访问80端口
- [ ] 外部可以访问443端口

---

## ✅ 功能测试

### HTTP/HTTPS
- [ ] HTTP访问自动重定向到HTTPS
- [ ] HTTPS访问正常
- [ ] SSL证书显示为有效
- [ ] 浏览器无安全警告

### API测试
- [ ] 健康检查端点正常（/api/health）
- [ ] 用户注册功能正常
- [ ] 用户登录功能正常
- [ ] Token验证功能正常
- [ ] 获取用户信息正常

### 余额系统
- [ ] 新用户注册获得默认余额
- [ ] 余额查询功能正常
- [ ] 余额扣费功能正常
- [ ] 余额记录查询正常
- [ ] 余额不足时正确拒绝

### 数据隔离
- [ ] 不同用户看不到对方的数据
- [ ] 知识库数据隔离正常
- [ ] 产品数据隔离正常
- [ ] 发布历史隔离正常

---

## ✅ 安全检查

### 密码安全
- [ ] 默认管理员密码已修改
- [ ] 所有密码符合强度要求
- [ ] 密码使用bcrypt加密
- [ ] 数据库密码不在代码中

### 访问控制
- [ ] JWT认证正常工作
- [ ] 未认证请求被正确拒绝
- [ ] 权限检查正常工作
- [ ] 请求频率限制生效

### 数据安全
- [ ] 敏感数据已加密存储
- [ ] SQL注入防护已启用
- [ ] XSS防护已启用
- [ ] CSRF防护已启用

### 网络安全
- [ ] HTTPS强制使用
- [ ] 安全头已配置
- [ ] 不必要的端口已关闭
- [ ] SSH密钥认证已启用

---

## ✅ 运维准备

### 备份
- [ ] 数据库备份脚本已创建
- [ ] 备份定时任务已配置
- [ ] 备份存储位置已确定
- [ ] 备份恢复流程已测试

### 监控
- [ ] 容器状态监控已配置
- [ ] 日志收集已配置
- [ ] 磁盘空间监控已配置
- [ ] 告警机制已配置

### 日志
- [ ] 应用日志正常输出
- [ ] 错误日志正常记录
- [ ] Nginx访问日志正常
- [ ] 日志轮转已配置

### 文档
- [ ] 部署文档已阅读
- [ ] 运维手册已准备
- [ ] 故障排查指南已准备
- [ ] 联系方式已记录

---

## ✅ 性能检查

### 响应时间
- [ ] 首页加载时间 < 2秒
- [ ] API响应时间 < 500ms
- [ ] 数据库查询时间 < 100ms

### 并发测试
- [ ] 10个并发用户正常
- [ ] 50个并发用户正常
- [ ] 系统资源使用合理

### 资源使用
- [ ] CPU使用率 < 70%
- [ ] 内存使用率 < 80%
- [ ] 磁盘使用率 < 70%
- [ ] 网络带宽充足

---

## ✅ 上线前最后检查

### 代码
- [ ] 所有调试代码已移除
- [ ] 所有TODO已处理
- [ ] 代码已提交到版本控制
- [ ] 版本号已更新

### 配置
- [ ] 生产环境配置已确认
- [ ] 开发环境配置已禁用
- [ ] 调试模式已关闭
- [ ] 日志级别已设置为info

### 数据
- [ ] 测试数据已清理
- [ ] 初始数据已导入
- [ ] 数据库索引已优化
- [ ] 数据库已备份

### 通知
- [ ] 团队成员已通知
- [ ] 用户已通知（如适用）
- [ ] 维护窗口已确定
- [ ] 回滚计划已准备

---

## ✅ 上线后验证

### 立即检查（上线后5分钟内）
- [ ] 所有容器运行正常
- [ ] 网站可以访问
- [ ] 用户可以登录
- [ ] 核心功能正常

### 短期检查（上线后1小时内）
- [ ] 无错误日志
- [ ] 性能指标正常
- [ ] 用户反馈正常
- [ ] 监控告警正常

### 中期检查（上线后24小时内）
- [ ] 系统稳定运行
- [ ] 无内存泄漏
- [ ] 无性能下降
- [ ] 备份正常执行

---

## 📝 检查记录

**检查人**: _______________
**检查日期**: _______________
**部署环境**: _______________
**版本号**: _______________

**未完成项**:
1. _______________
2. _______________
3. _______________

**备注**:
_______________________________________________
_______________________________________________
_______________________________________________

---

## 🚨 紧急联系

**技术负责人**: _______________
**电话**: _______________
**邮箱**: _______________

**服务器信息**:
- IP: _______________
- SSH端口: _______________
- 登录用户: _______________

**重要密码位置**: _______________

---

**检查完成后，请保存此清单作为部署记录。**
